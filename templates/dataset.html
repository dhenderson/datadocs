{% extends "base.html" %}
{% block title %}
  {% if dataset.title %}
    {{dataset.title}}
  {% else %}
    {{dataset.name}}
  {% endif %}
{% endblock %}
{% block subheader %}
{% if dataset.title %}
  {{dataset.title}}
{% else %}
  {{dataset.name}}
{% endif %}
{% endblock %}
{% block content %}

  <div class="row">
    <div class="col-md-3 bs-docs-sidebar">
      <ul id="sidebar" class="nav nav-stacked fixed">
      {% for category in dataset.columnsByCategory %}
        <li>
          <a href="#category-{{loop.index}}">{{category}} <span class="badge">{{dataset.columnsByCategory[category]|length}}</span></a>
        </li>
      {% endfor %}
      </ul>
    </div>
    <div class="col-md-9">
      {% for category in dataset.columnsByCategory %}
        <script type="text/javascript">
          $(document).ready(function() {
              $('#dataset-table-{{loop.index}}').DataTable({
                "paging": false,
                "order": [[ 3, "desc" ]]
              });
          } );
        </script>
        <h2 id="category-{{loop.index}}">{{category}}</h2>
        <table class="table" id="dataset-table-{{loop.index}}">
          <thead>
            <tr>
              <th>Column</th>
              <th>Description</th>
              <th>Data type</th>
              {% if showPercentAnswered %}
              <th>Percent answerd</th>
              {% endif %}
            </tr>
          </thead>
          <tbody>
            {% for column in dataset.columnsByCategory[category] %}
            <tr>
              <td>{{column.name}}</td>
              <td>{{column.description}}</td>
              <td>{{column.dataType}}</td>
              {% if showPercentAnswered %}
              <td>
                <div class="progress">
                  <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="{{column.percentNotNA}}" aria-valuemin="0" aria-valuemax="100" style="width: {{column.percentNotNA}}%; min-width: 2em;">
                    {{column.percentNotNA}}%
                  </div>
                </div>
              </td>
              {% endif %}
            </tr>
            {% endfor %}
          </tbody>
        </table>
      {% endfor %}
    </div>
  </div>

  <script type="text/javascript">
  $('body').scrollspy({
      target: '.bs-docs-sidebar',
      offset: 40
  });
  </script>

{% endblock %}
